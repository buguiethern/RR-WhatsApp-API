services:
  rr-whatsapp-api:
    restart: unless-stopped
    build:
      context: .
      dockerfile: Dockerfile
    environment:
      # ajuste conforme suas redes
      ALLOWED_IPS: "127.0.0.1,::1,10.10.10.0/24,10.10.20.0/24,10.0.2.0/24,10.0.0.0/8,172.16.0.0/12"
      PORT: "3001"
      WS_PORT: "8080"
    volumes:
      - ./index.js:/opt/RR-WhatsApp-API/index.js
      # ✅ persiste a sessão do WhatsApp (evita perder login ao recriar container)
      - rr_session:/opt/RR-WhatsApp-API/session
    ports:
      # ✅ sugiro fixar: host:container
      - "3001:3001"
      - "8080:8080"

volumes:
  rr_session: